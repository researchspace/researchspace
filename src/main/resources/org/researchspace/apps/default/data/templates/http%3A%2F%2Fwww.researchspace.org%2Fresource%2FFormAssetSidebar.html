
<div style="margin-top: 20px;">
    <div class="customFormHeader" style="padding-top: 0;">Related media/resources</div>

    [[#if imagesOnly]]
        <bs-tab-container id="{{viewId}}-formResourceAsset-tabs" default-active-key="{{viewId}}-images-thumbnailView" class="form-assetView-tabs">
            <div>
                <div class="page__section-container form-tabs-subtabs-content" style="overflow: hidden; padding: 12px 20px; margin: 0; display: flex; flex-direction: column; height: 100%;">
                    <div class="form-tabs-subtabs-content--title">
                        <h4 style="margin-top: 0;">Images</h4>
                        <div style="display: flex;align-items: center;gap: 20px;">
                            {{#if node}}
                                <semantic-if    query='ASK { <{{node}}> crm:P138i_has_representation|rso:PX_has_main_representation ?image . 
                                                            ?image a ?type .
                                                            FILTER(?type in (rs:EX_Digital_Image, rs:EX_Digital_Image_Region))
                                                        }'
                                                then='{{> then}}'>

                                    <template id='then'>
                                        <div class="form-tabs-subtabs-content--title-actions">
                                            <mp-overlay-dialog  id="[[urlParam 'viewid' escape=false]]-resource-imagePreview-dialog"  
                                                                type="modal" 
                                                                class="modal-xlSize preview_modal"
                                                                title="Image preview">
                                                <mp-overlay-dialog-trigger>
                                                    <button class="btn btn-icon" title="Image preview">
                                                        <rs-icon icon-type="rounded" icon-name="fullscreen" symbol="true"></rs-icon>
                                                    </button>
                                                </mp-overlay-dialog-trigger>

                                                <mp-overlay-dialog-content>
                                                    <inline-template template-iri='[[resolvePrefix "rsp:ResourceImagesPreview"]]' 
                                                                    options='{  "resource": "{{node}}"  }' >
                                                    </inline-template> 
                                                </mp-overlay-dialog-content>
                                            </mp-overlay-dialog>

                                            <mp-event-trigger id='{{viewId}}-image-annotation-add-frame-trigger' 
                                                                type='Dashboard.AddFrame' 
                                                                data='{"resourceIri": "{{node}}", 
                                                                        "viewId": "image-annotation", 
                                                                        "frameId": "{{viewId}}"}' 
                                                                targets='["thinking-frames"]'>
                                                <button class="btn btn-icon" title="Image view / annotations">
                                                    <rs-icon icon-type="rounded" icon-name="photo_size_select_large" symbol="true"></rs-icon>
                                                </button>
                                            </mp-event-trigger>
                                        </div>
                                    </template>
                                </semantic-if>
                            {{/if}}
                        
                            <bs-nav class="icon-tabs">
                                <bs-nav-item event-key="{{viewId}}-images-thumbnailView" title="thumbnail view">
                                    <rs-icon icon-type="sharp" icon-name="view_module"></rs-icon>
                                </bs-nav-item>
                                <bs-nav-item event-key="{{viewId}}-images-listView" title="list view">
                                    <rs-icon icon-type="sharp" icon-name="view_list"></rs-icon>
                                </bs-nav-item>
                            </bs-nav>
                        </div>
                    </div>
                    <bs-tab-content animation="true" >
                        <bs-tab-pane event-key="{{viewId}}-images-thumbnailView">
                            <div class="tab-pane-content" style="padding-top: 0;">
                                <div class="dragAndDrop-input-container">
                                    <semantic-form-drag-and-drop-input  for='entity_image_main_representation' 
                                                                        label="Main image" 
                                                                        placeholder-item-template="<div class='placeholder-item'>
                                                                                                        <rs-icon icon-type='rounded' icon-name='upload' class='upload_icon' symbol='true'></rs-icon>
                                                                                                        <div>
                                                                                                            <div style='margin-bottom:3px;'>Drag main image from </div>
                                                                                                            <div style='margin-bottom:7px;'>
                                                                                                                <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                class='text-link' 
                                                                                                                                urlqueryparam-view='resource-search'
                                                                                                                                urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image'
                                                                                                                                urlqueryparam-custom-label='Search Image'>
                                                                                                                                Image Library
                                                                                                                </semantic-link>
                                                                                                            
                                                                                                                <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                            urlqueryparam-view='resource-search' 
                                                                                                                                            urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image'
                                                                                                                                            urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                            urlqueryparam-custom-label='Search Image'
                                                                                                                                            >
                                                                                                                    <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding-left: 5px;' title='Open Image Library in new draggable tab'></rs-icon>
                                                                                                                </semantic-link-container>
                                                                                                        
                                                                                                                <span style='padding:0 3px;'> or </span>
                                                                                                        
                                                                                                                <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                class='text-link' 
                                                                                                                                urlqueryparam-view='resource-search'
                                                                                                                                urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                                                                                                                urlqueryparam-custom-label='Search image annotation'>
                                                                                                                    Image Annotation Library
                                                                                                                </semantic-link>
                                                                                                            
                                                                                                                <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                            urlqueryparam-view='resource-search' 
                                                                                                                                            urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                                                                                                                            urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                            urlqueryparam-custom-label='Search image annotation'
                                                                                                                                            >
                                                                                                                    <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding-left: 5px;' title='Open Image Annotation Library in new draggable tab'></rs-icon>
                                                                                                                </semantic-link-container>
                                                                                                            </div>
                                                                                                            <span>or </span><span class='text-link'>click to upload</span>
                                                                                                        </div>
                                                                                                    </div>"
                                                                        nested-form-template='{{{{raw}}}}{{> forms:Image nested=true editable=true mode="new"}}{{{{/raw}}}}'>
                                    </semantic-form-drag-and-drop-input>

                                </div>
                                <div class="dragAndDrop-input-container">
                                    <semantic-form-drag-and-drop-input  for='entity_image' 
                                                                        label="More images"
                                                                        placeholder-item-template="<div class='placeholder-item'>
                                                                                                        <rs-icon icon-type='rounded' icon-name='upload' class='upload_icon' symbol='true'></rs-icon>
                                                                                                        <div>
                                                                                                            <div style='margin-bottom:3px;'>Drag image from </div>
                                                                                                            <div style='margin-bottom:7px;'>
                                                                                                                <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                class='text-link' 
                                                                                                                                urlqueryparam-view='resource-search'
                                                                                                                                urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image'
                                                                                                                                urlqueryparam-custom-label='Search Image'>
                                                                                                                                Image Library
                                                                                                                </semantic-link>
                                                                                                            
                                                                                                                <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                            urlqueryparam-view='resource-search' 
                                                                                                                                            urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image'
                                                                                                                                            urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                            urlqueryparam-custom-label='Search Image'
                                                                                                                                            >
                                                                                                                    <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding-left: 5px;' title='Open Image Library in new draggable tab'></rs-icon>
                                                                                                                </semantic-link-container>
                                                                                                        
                                                                                                                <span style='padding:0 3px;'> or </span>
                                                                                                        
                                                                                                                <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                class='text-link' 
                                                                                                                                urlqueryparam-view='resource-search'
                                                                                                                                urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                                                                                                                urlqueryparam-custom-label='Search image annotation'>
                                                                                                                    Image Annotation Library
                                                                                                                </semantic-link>
                                                                                                            
                                                                                                                <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                            urlqueryparam-view='resource-search' 
                                                                                                                                            urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                                                                                                                            urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                            urlqueryparam-custom-label='Search image annotation'
                                                                                                                                            >
                                                                                                                    <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding-left: 5px;' title='Open Image Annotation Library in new draggable tab'></rs-icon>
                                                                                                                </semantic-link-container>
                                                                                                            </div>
                                                                                                            <span>or </span><span class='text-link'>click to upload</span>
                                                                                                        </div>
                                                                                                    </div>"
                                                                        nested-form-template='{{{{raw}}}}{{> forms:Image nested=true editable=true mode="new"}}{{{{/raw}}}}'>
                                    </semantic-form-drag-and-drop-input>
                                </div>
                            </div>
                        </bs-tab-pane>

                        <bs-tab-pane event-key="{{viewId}}-images-listView">
                            <div class="tab-pane-content" style="padding-top: 0;">
                            
                                <semantic-form-autocomplete-input   for='entity_image_main_representation' 
                                                                    label="Main image"
                                                                    placeholder="Select image" 
                                                                    nested-form-templates='[ 
                                                                        {
                                                                            "label": "Image",
                                                                            "nestedForm": "{{{{raw}}}}
                                                                                            {{> \"http://www.researchspace.org/resource/system/forms/Image\" nested=true editable=true mode=\"new\"}}
                                                                                        {{{{/raw}}}}"
                                                                        }
                                                                    ]'> 
                                </semantic-form-autocomplete-input>
                        
                                <semantic-form-autocomplete-input   for='entity_image' 
                                                                    label="More images"
                                                                    placeholder="Select image" 
                                                                    nested-form-templates='[ 
                                                                        {
                                                                            "label": "Image",
                                                                            "nestedForm": "{{{{raw}}}}{{> \"http://www.researchspace.org/resource/system/forms/Image\" nested=true editable=true mode=\"new\" }}{{{{/raw}}}}"
                                                                        }
                                                                    
                                                                    ]'> 
                                </semantic-form-autocomplete-input>
                            </div>
                        </bs-tab-pane>
                    </bs-tab-content>
                </div>
            </div>
        </bs-tab-container>
    [[else]]
        <bs-tab-container id="{{viewId}}-formResourceAsset-tabs" default-active-key="[[#if map]]{{viewId}}-resourceForm-map[[else]]{{viewId}}-resourceForm-images[[/if]]">
            <div class="formResourceAsset-tabs">
                <bs-nav class="btn btn-secondary" style="width: 100%;">
                    <bs-nav-dropdown event-key="{{viewId}}-resources" title="Media type">
                        <bs-menu-item event-key="{{viewId}}-resourceForm-audio">Audio</bs-menu-item>
                        <bs-menu-item event-key="{{viewId}}-resourceForm-docs">Document</bs-menu-item>
                        <bs-menu-item event-key="{{viewId}}-resourceForm-images">Image</bs-menu-item>
                        [[#if map]]<bs-menu-item event-key="{{viewId}}-resourceForm-map">Map</bs-menu-item>[[/if]]
                        <bs-menu-item event-key="{{viewId}}-resourceForm-3d">Models 3D</bs-menu-item>
                        [[#if signature]]<bs-menu-item event-key="{{viewId}}-resourceForm-signature">Signature</bs-menu-item>[[/if]]
                        <bs-menu-item event-key="{{viewId}}-resourceForm-videos">Video</bs-menu-item>
                        <bs-menu-item event-key="{{viewId}}-resourceForm-representations">Visual representation</bs-menu-item>
                        <bs-menu-item event-key="{{viewId}}-resourceForm-URLlink">Web URL link</bs-menu-item>
                    </bs-nav-dropdown>
                </bs-nav>
                    
                <bs-tab-content animation="true" class="page__section-container">

                    <bs-tab-pane event-key="{{viewId}}-resourceForm-audio" class="form-tabs-subtabs-content">
                        <bs-tab-container id="{{viewId}}-form-audio-tabs" default-active-key="thumbnailView" class="form-assetView-tabs">
                            <div>
                                <div class="form-tabs-subtabs-content--title">
                                    <h4>Audio</h4>
                                    <bs-nav class="icon-tabs">
                                        <bs-nav-item event-key="thumbnailView" title="thumbnail view">
                                            <rs-icon icon-type="sharp" icon-name="view_module"></rs-icon>
                                        </bs-nav-item>
                                        <bs-nav-item event-key="listView" title="list view">
                                            <rs-icon icon-type="sharp" icon-name="view_list"></rs-icon>
                                        </bs-nav-item>
                                    </bs-nav>
                                </div>
                    
                                <bs-tab-content>
                                    <bs-tab-pane event-key="thumbnailView">
                                        <div class="tab-pane-content">
                                            <div class="dragAndDrop-input-container">
                                                <semantic-form-drag-and-drop-input  for='entity_audio' 
                                                                                    label="Audio" 
                                                                                    render-header=false
                                                                                    placeholder-item-template="<div class='placeholder-item'>
                                                                                                                    <rs-icon icon-type='rounded' icon-name='upload' class='upload_icon' symbol='true'></rs-icon>
                                                                                                                    <div>
                                                                                                                        <span>Drag audio from </span>
                                                                                                                        <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                        class='text-link' 
                                                                                                                                        urlqueryparam-view='resource-search'
                                                                                                                                        urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Audio'
                                                                                                                                        urlqueryparam-custom-label='Search Audio'>
                                                                                                                                        Audio Library
                                                                                                                        </semantic-link>
                                                                                                                    
                                                                                                                        <semantic-link-container    uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                                    urlqueryparam-view='resource-search' 
                                                                                                                                                    urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Audio'
                                                                                                                                                    urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                                    urlqueryparam-custom-label='Search Audio'
                                                                                                                                                >
                                                                                                                            <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding:0 8px 0 5px;' title='Open Audio Library in new draggable tab'></rs-icon>
                                                                                                                        </semantic-link-container>
                                                                                                                        <span>or </span><span class='text-link'>click to upload</span>
                                                                                                                    </div>
                                                                                                                </div>"
                                                                                    nested-form-template='{{{{raw}}}}{{> forms:Audio nested=true editable=true mode="new"}}{{{{/raw}}}}'
                                                                                                                >
                                                </semantic-form-drag-and-drop-input>
                                            </div>
                                        </div>
                                    </bs-tab-pane>
        
                                    <bs-tab-pane event-key="listView">
                                        <div class="tab-pane-content">
                                            <semantic-form-autocomplete-input   for='entity_audio' 
                                                                                label="Audio"
                                                                                render-header="false"
                                                                                placeholder="Select audio" 
                                                                                nested-form-templates='[ 
                                                                                    {
                                                                                        "label": "Audio",
                                                                                        "nestedForm": "{{{{raw}}}}
                                                                                                        {{> \"http://www.researchspace.org/resource/system/forms/Audio\" nested=true editable=true mode=\"new\"}}
                                                                                                    {{{{/raw}}}}"
                                                                                    }
                                                                                ]'> 
                                            </semantic-form-autocomplete-input>
                                        </div>
                                    </bs-tab-pane>
                                </bs-tab-content>
                            </div>
                        </bs-tab-container>
                    </bs-tab-pane>

                    <bs-tab-pane event-key="{{viewId}}-resourceForm-docs" class="form-tabs-subtabs-content">
                        <bs-tab-container id="{{viewId}}-form-document-tabs" default-active-key="thumbnailView" class="form-assetView-tabs">
                            <div>
                                <div class="form-tabs-subtabs-content--title">
                                    <h4>Documents</h4>
                                    <div>
                                        <bs-nav class="icon-tabs">
                                            <bs-nav-item event-key="thumbnailView" title="thumbnail view">
                                                <rs-icon icon-type="sharp" icon-name="view_module"></rs-icon>
                                            </bs-nav-item>
                                            <bs-nav-item event-key="listView" title="list view">
                                                <rs-icon icon-type="sharp" icon-name="view_list"></rs-icon>
                                            </bs-nav-item>
                                        </bs-nav>
                                    </div>
                                </div>
                    
                                <bs-tab-content>
                                    <bs-tab-pane event-key="thumbnailView">
                                        <div class="tab-pane-content">
                                            <div class="dragAndDrop-input-container">
                                                <semantic-form-drag-and-drop-input  for='entity_document' 
                                                                                    label="Documents" 
                                                                                    render-header=false
                                                                                    placeholder-item-template="<div class='placeholder-item'>
                                                                                                                    <rs-icon icon-type='rounded' icon-name='upload' class='upload_icon' symbol='true'></rs-icon>
                                                                                                                    <div>
                                                                                                                        <span>Drag document from </span>
                                                                                                                        <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                        class='text-link' 
                                                                                                                                        urlqueryparam-view='resource-search'
                                                                                                                                        urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Document'
                                                                                                                                        urlqueryparam-custom-label='Search Document'>
                                                                                                                                        Document Library
                                                                                                                        </semantic-link>
                                                                                                                    
                                                                                                                        <semantic-link-container    uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                                    urlqueryparam-view='resource-search' 
                                                                                                                                                    urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Document'
                                                                                                                                                    urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                                    urlqueryparam-custom-label='Search Document'
                                                                                                                                                >
                                                                                                                            <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding:0 8px 0 5px;' title='Open Document Library in new draggable tab'></rs-icon>
                                                                                                                        </semantic-link-container>
                                                                                                                        <span>or </span><span class='text-link'>click to upload</span>
                                                                                                                    </div>
                                                                                                                </div>"
                                                                                    nested-form-template='{{{{raw}}}}{{> forms:Document nested=true editable=true mode="new"}}{{{{/raw}}}}'
                                                                                                                >
                                                </semantic-form-drag-and-drop-input>
                                            </div>
                                        </div>
                                    </bs-tab-pane>
        
                                    <bs-tab-pane event-key="listView">
                                        <div class="tab-pane-content">
                                            <semantic-form-autocomplete-input for='entity_document' 
                                                                                label="Documents"
                                                                                render-header="false"
                                                                                placeholder="Select document" 
                                                                                nested-form-templates='[ 
                                                                                    {
                                                                                        "label": "Document",
                                                                                        "nestedForm": "{{{{raw}}}}
                                                                                                        {{> \"http://www.researchspace.org/resource/system/forms/Document\" nested=true editable=true mode=\"new\"}}
                                                                                                    {{{{/raw}}}}"
                                                                                    }
                                                                                ]'> 
                                            </semantic-form-autocomplete-input>
                                        </div>
                                    </bs-tab-pane>
                                </bs-tab-content>
                                
                            </div>
                        </bs-tab-container>
                    </bs-tab-pane>

                    <bs-tab-pane event-key="{{viewId}}-resourceForm-images" class="form-tabs-subtabs-content">
                        <bs-tab-container id="{{viewId}}-form-image-tabs" default-active-key="thumbnailView" class="form-assetView-tabs">
                            <div>
                                <div class="form-tabs-subtabs-content--title">
                                    <h4>Images</h4>
                                    <div style="display: flex;align-items: center;gap: 20px;">
                                        {{#if node}}
                                            <semantic-if    query='ASK { <{{node}}> crm:P138i_has_representation|rso:PX_has_main_representation ?image . 
                                                                        ?image a ?type .
                                                                        FILTER(?type in (rs:EX_Digital_Image, rs:EX_Digital_Image_Region))
                                                                    }'
                                                            then='{{> then}}'>

                                                <template id='then'>
                                                    <div class="form-tabs-subtabs-content--title-actions">
                                                        <mp-overlay-dialog  id="[[urlParam 'viewid' escape=false]]-resource-imagePreview-dialog"  
                                                                            type="modal" 
                                                                            class="modal-xlSize preview_modal"
                                                                            title="Image preview">
                                                            <mp-overlay-dialog-trigger>
                                                                <button class="btn btn-icon" title="Image preview">
                                                                    <rs-icon icon-type="rounded" icon-name="fullscreen" symbol="true"></rs-icon>
                                                                </button>
                                                            </mp-overlay-dialog-trigger>

                                                            <mp-overlay-dialog-content>
                                                                <inline-template template-iri='[[resolvePrefix "rsp:ResourceImagesPreview"]]' 
                                                                                options='{  "resource": "{{node}}"
                                                                                            }' >
                                                                </inline-template> 
                                                            </mp-overlay-dialog-content>
                                                        </mp-overlay-dialog>
                        
                                                        <mp-event-trigger id='{{viewId}}-image-annotation-add-frame-trigger' 
                                                                            type='Dashboard.AddFrame' 
                                                                            data='{"resourceIri": "{{node}}", 
                                                                                    "viewId": "image-annotation", 
                                                                                    "frameId": "{{viewId}}"}' 
                                                                            targets='["thinking-frames"]'>
                                                            <button class="btn btn-icon" title="Image view / annotations">
                                                                <rs-icon icon-type="rounded" icon-name="photo_size_select_large" symbol="true"></rs-icon>
                                                            </button>
                                                        </mp-event-trigger>
                                                    </div>
                                                </template>
                                            </semantic-if>
                                        {{/if}}
                                    
                                        <bs-nav class="icon-tabs">
                                            <bs-nav-item event-key="thumbnailView" title="thumbnail view">
                                                <rs-icon icon-type="sharp" icon-name="view_module"></rs-icon>
                                            </bs-nav-item>
                                            <bs-nav-item event-key="listView" title="list view">
                                                <rs-icon icon-type="sharp" icon-name="view_list"></rs-icon>
                                            </bs-nav-item>
                                        </bs-nav>
                                    </div>
                                </div>
                                <bs-tab-content>
                                    <bs-tab-pane event-key="thumbnailView">
                                        <div class="tab-pane-content" style="padding-top: 0;">
                                            <div class="dragAndDrop-input-container">
                                                <semantic-form-drag-and-drop-input  for='entity_image_main_representation' 
                                                                                    label="Main image" 
                                                                                    placeholder-item-template="<div class='placeholder-item'>
                                                                                                                    <rs-icon icon-type='rounded' icon-name='upload' class='upload_icon' symbol='true'></rs-icon>
                                                                                                                    <div>
                                                                                                                        <div style='margin-bottom:3px;'>Drag main image from </div>
                                                                                                                        <div style='margin-bottom:7px;'>
                                                                                                                            <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                            class='text-link' 
                                                                                                                                            urlqueryparam-view='resource-search'
                                                                                                                                            urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image'
                                                                                                                                            urlqueryparam-custom-label='Search Image'>
                                                                                                                                            Image Library
                                                                                                                            </semantic-link>
                                                                                                                        
                                                                                                                            <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                                        urlqueryparam-view='resource-search' 
                                                                                                                                                        urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image'
                                                                                                                                                        urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                                        urlqueryparam-custom-label='Search Image'
                                                                                                                                                        >
                                                                                                                                <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding-left: 5px;' title='Open Image Library in new draggable tab'></rs-icon>
                                                                                                                            </semantic-link-container>
                                                                                                                    
                                                                                                                            <span style='padding:0 3px;'> or </span>
                                                                                                                    
                                                                                                                            <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                            class='text-link' 
                                                                                                                                            urlqueryparam-view='resource-search'
                                                                                                                                            urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                                                                                                                            urlqueryparam-custom-label='Search image annotation'>
                                                                                                                                Image Annotation Library
                                                                                                                            </semantic-link>
                                                                                                                        
                                                                                                                            <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                                        urlqueryparam-view='resource-search' 
                                                                                                                                                        urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                                                                                                                                        urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                                        urlqueryparam-custom-label='Search image annotation'
                                                                                                                                                        >
                                                                                                                                <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding-left: 5px;' title='Open Image Annotation Library in new draggable tab'></rs-icon>
                                                                                                                            </semantic-link-container>
                                                                                                                        </div>
                                                                                                                        <span>or </span><span class='text-link'>click to upload</span>
                                                                                                                    </div>
                                                                                                                </div>"
                                                                                    nested-form-template='{{{{raw}}}}{{> forms:Image nested=true editable=true mode="new"}}{{{{/raw}}}}'>
                                                </semantic-form-drag-and-drop-input>

                                            </div>
                                            <div class="dragAndDrop-input-container">
                                                <semantic-form-drag-and-drop-input  for='entity_image' 
                                                                                    label="More images"
                                                                                    placeholder-item-template="<div class='placeholder-item'>
                                                                                                                    <rs-icon icon-type='rounded' icon-name='upload' class='upload_icon' symbol='true'></rs-icon>
                                                                                                                    <div>
                                                                                                                        <div style='margin-bottom:3px;'>Drag image from </div>
                                                                                                                        <div style='margin-bottom:7px;'>
                                                                                                                            <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                            class='text-link' 
                                                                                                                                            urlqueryparam-view='resource-search'
                                                                                                                                            urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image'
                                                                                                                                            urlqueryparam-custom-label='Search Image'>
                                                                                                                                            Image Library
                                                                                                                            </semantic-link>
                                                                                                                        
                                                                                                                            <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                                        urlqueryparam-view='resource-search' 
                                                                                                                                                        urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image'
                                                                                                                                                        urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                                        urlqueryparam-custom-label='Search Image'
                                                                                                                                                        >
                                                                                                                                <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding-left: 5px;' title='Open Image Library in new draggable tab'></rs-icon>
                                                                                                                            </semantic-link-container>
                                                                                                                    
                                                                                                                            <span style='padding:0 3px;'> or </span>
                                                                                                                    
                                                                                                                            <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                            class='text-link' 
                                                                                                                                            urlqueryparam-view='resource-search'
                                                                                                                                            urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                                                                                                                            urlqueryparam-custom-label='Search image annotation'>
                                                                                                                                Image Annotation Library
                                                                                                                            </semantic-link>
                                                                                                                        
                                                                                                                            <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                                        urlqueryparam-view='resource-search' 
                                                                                                                                                        urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                                                                                                                                        urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                                        urlqueryparam-custom-label='Search image annotation'
                                                                                                                                                        >
                                                                                                                                <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding-left: 5px;' title='Open Image Annotation Library in new draggable tab'></rs-icon>
                                                                                                                            </semantic-link-container>
                                                                                                                        </div>
                                                                                                                        <span>or </span><span class='text-link'>click to upload</span>
                                                                                                                    </div>
                                                                                                                </div>"
                                                                                    nested-form-template='{{{{raw}}}}{{> forms:Image nested=true editable=true mode="new"}}{{{{/raw}}}}'>
                                                </semantic-form-drag-and-drop-input>
                                            </div>
                                        </div>
                                    </bs-tab-pane>
        
                                    <bs-tab-pane event-key="listView">
                                        <div class="tab-pane-content" style="padding-top: 0;">
                                        
                                            <semantic-form-autocomplete-input   for='entity_image_main_representation' 
                                                                                label="Main image"
                                                                                placeholder="Select image" 
                                                                                nested-form-templates='[ 
                                                                                    {
                                                                                        "label": "Image",
                                                                                        "nestedForm": "{{{{raw}}}}
                                                                                                        {{> \"http://www.researchspace.org/resource/system/forms/Image\" nested=true editable=true mode=\"new\"}}
                                                                                                    {{{{/raw}}}}"
                                                                                    }
                                                                                ]'> 
                                            </semantic-form-autocomplete-input>
                                    
                                            <semantic-form-autocomplete-input   for='entity_image' 
                                                                                label="More images"
                                                                                placeholder="Select image" 
                                                                                nested-form-templates='[ 
                                                                                    {
                                                                                        "label": "Image",
                                                                                        "nestedForm": "{{{{raw}}}}{{> \"http://www.researchspace.org/resource/system/forms/Image\" nested=true editable=true mode=\"new\" }}{{{{/raw}}}}"
                                                                                    }
                                                                                
                                                                                ]'> 
                                            </semantic-form-autocomplete-input>
                                        </div>
                                    </bs-tab-pane>
                                </bs-tab-content>
                            </div>
                        </bs-tab-container>
                    </bs-tab-pane>

                    [[#if map]]
                        <bs-tab-pane event-key="{{viewId}}-resourceForm-map" class="form-tabs-subtabs-content">
                            
                            {{#if node}}
                                <semantic-query query='SELECT DISTINCT ?place ?placeName ?osmURI WHERE {
                                                        BIND(<{{node}}> AS ?place)

                                                        ?place crm:P168_place_is_defined_by ?osm_geoCoordinates .
                                                        ?osm_geoCoordinates crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/osm_geographic_coordinates> .
                                                        ?osm_geoCoordinates crm:P190_has_symbolic_content ?wkt .
                
                                                        OPTIONAL {
                                                            ?place crm:P129i_is_subject_of ?entityFormRecord .
                                                            ?entityFormRecord crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/entity_form_record> . 
                                                            ?entityFormRecord crmdig:L11i_was_output_of ?entityFormRecordCreation .
                                                            ?entityFormRecordCreation crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/entity_form_record_creation> .
                                                            ?entityFormRecordCreation crm:P134_continued ?importFromExternalSource .
                                                            ?importFromExternalSource crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/import_from_external_source> .
                                                            ?importFromExternalSource crmdig:L14_transferred ?osmURI .
                                                            ?osmURI crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/digital_object_type/web_link> .
                                                        }
                
                                                        ?place crm:P1_is_identified_by ?appellation . 
                                                        ?appellation crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/primary_appellation> . 
                                                        ?appellation crm:P190_has_symbolic_content ?placeName .
                                                    } LIMIT 1'
                                                template='{{> template}}'
                                                no-result-template='{{> noResults}}'
                                >
                                        
                                    <template id='template'>
                                        <div>
                                            <div class="form-tabs-subtabs-content--title">
                                                <h4>Map</h4>
                                                <div style="display: flex;align-items: center;gap: 20px;">
                                                    <div class="form-tabs-subtabs-content--title-actions">
                                                        <mp-overlay-dialog  id="[[urlParam 'viewid' escape=false]]-resource-mapPreview-dialog"  
                                                                            type="modal" 
                                                                            class="modal-xlSize preview_modal"
                                                                            title="Map preview">
                                                            <mp-overlay-dialog-trigger>
                                                                <button class="btn btn-icon" title="Map preview">
                                                                    <rs-icon icon-type="rounded" icon-name="fullscreen" symbol="true"></rs-icon>
                                                                </button>
                                                            </mp-overlay-dialog-trigger>

                                                            <mp-overlay-dialog-content>
                                                                <inline-template template-iri='[[resolvePrefix "rsp:ResourceMapPreview"]]' 
                                                                                options='{  "resource": "{{node}}",
                                                                                            "placeName": "{{bindings.0.placeName.value}}",
                                                                                            "osmURI": "{{bindings.0.osmURI.value}}"
                                                                                            }' >
                                                                </inline-template> 
                                                            </mp-overlay-dialog-content>
                                                        </mp-overlay-dialog>

                                                        <semantic-link-container    uri='[[resolvePrefix "rsp:ThinkingFrames"]]'
                                                                                    urlqueryparam-view='map' 
                                                                                    urlqueryparam-resource='{{node}}'>
                                                            <button class="btn btn-icon" title="Open map">
                                                                <rs-icon icon-type="rounded" icon-name="place" symbol="true"></rs-icon>
                                                            </button>
                                                        </semantic-link-container>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style='height: 350px; width: 100%; margin: 10px 0 0;'>
                                                <semantic-map   query='SELECT ?wkt WHERE { 
                                                                        <{{bindings.0.place.value}}> crm:P168_place_is_defined_by ?osm_geoCoordinates .
                                                                        ?osm_geoCoordinates crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/osm_geographic_coordinates> .
                                                                        ?osm_geoCoordinates crm:P190_has_symbolic_content ?wkt .
                                                                    }'
                                                                tuple-template='<div style="display:flex; flex-direction:column; gap:5px;">
                                                                                    <b style="color:#525156;">{{bindings.0.placeName.value}}</b>
                                                                                    {{#if bindings.0.osmURI.value}}
                                                                                        <div>
                                                                                            <a style="color:#396EFE;"
                                                                                                target="_blank" 
                                                                                                href="{{bindings.0.osmURI.value}}"
                                                                                                title="{{bindings.0.osmURI.value}}">
                                                                                                Open in wikidata
                                                                                            </a>
                                                                                        </div>
                                                                                    {{/if}}
                                                                                </div>'>
                                                </semantic-map>
                                            </div>
                                            {{#if bindings.0.osmURI.value}}
                                                <div style="padding-top: 5px;">
                                                    <span>Imported from: </span>
                                                    <a class="text-link-action" target="_blank" href="{{bindings.0.osmURI.value}}" title="{{bindings.0.osmURI.value}}">{{bindings.0.osmURI.value}}</a>
                                                </div>
                                            {{/if}}
                                        </div>
                                    </template>

                                    <template id="noResults">
                                        <div class="form-tabs-subtabs-content--title">
                                            <h4>Map</h4>
                                        </div>
                                        <div class="page__section-container-whiteBg" style="margin-top: 10px; font-size: 12.5px;">Enter the geographic coordinates (OpenStreetMap) in location details to display the place map.</div>
                                    </template>
                                </semantic-query>
                            {{else}}
                                <div class="form-tabs-subtabs-content--title">
                                    <h4>Map</h4>
                                </div>
                                {{#if apiResourceosmGeoCoordinates}}
                                    <div style='height: 350px; width: 100%; margin: 10px 0 0;'>
                                        <semantic-map query='SELECT ?wkt WHERE { BIND("{{apiResourceosmGeoCoordinates}}" AS ?wkt) }'
                                                        tuple-template='<div style="display:flex; flex-direction:column; gap:5px;">
                                                                            {{#if apiResourceName}}<b style="color:#525156;">{{apiResourceName}}</b>{{/if}}
                                                                            {{#if apiResourceURI}}
                                                                                <div>
                                                                                    <a style="color:#396EFE;"
                                                                                        target="_blank" 
                                                                                        href="{{apiResourceURI}}"
                                                                                        title="{{apiResourceURI}}">
                                                                                    Open in wikidata
                                                                                    </a>
                                                                                </div>
                                                                            {{/if}}
                                                                        </div>'>
                                        </semantic-map>
                                    </div>
                                {{else}}
                                    <div class="page__section-container-whiteBg" style="margin-top: 10px; font-size: 12.5px;">Enter the geographic coordinates (OpenStreetMap) in location details to display the place map.</div>
                                {{/if}}
                                
                                {{#if apiResourceURI}}
                                    <div style="padding-top: 5px;">
                                        <span>Imported from: </span>
                                        <a class="text-link-action" target="_blank" href="{{apiResourceURI}}" title="{{apiResourceURI}}">{{apiResourceURI}}</a>
                                    </div>
                                {{/if}}
                            {{/if}}
                        </bs-tab-pane>
                    [[/if]]

                    <bs-tab-pane event-key="{{viewId}}-resourceForm-3d" class="form-tabs-subtabs-content">
                        <bs-tab-container id="{{viewId}}-form-3d-tabs" default-active-key="thumbnailView" class="form-assetView-tabs">
                            <div>
                                <div class="form-tabs-subtabs-content--title">
                                    <h4>3D models</h4>
                                    <div style="display: flex;align-items: center;gap: 20px;">
                                        <bs-nav class="icon-tabs">
                                            <bs-nav-item event-key="thumbnailView" title="thumbnail view">
                                                <rs-icon icon-type="sharp" icon-name="view_module"></rs-icon>
                                            </bs-nav-item>
                                            <bs-nav-item event-key="listView" title="list view">
                                                <rs-icon icon-type="sharp" icon-name="view_list"></rs-icon>
                                            </bs-nav-item>
                                        </bs-nav>
                                    </div>
                                </div>
                    
                                <bs-tab-content>
                                    <bs-tab-pane event-key="thumbnailView">
                                        <div class="tab-pane-content">
                                            <div class="dragAndDrop-input-container">
                                                <semantic-form-drag-and-drop-input  for='entity_3d_model' 
                                                                                    label="3D model" 
                                                                                    render-header=false
                                                                                    placeholder-item-template="<div class='placeholder-item'>
                                                                                                                    <rs-icon icon-type='rounded' icon-name='upload' class='upload_icon' symbol='true'></rs-icon>
                                                                                                                    <div>
                                                                                                                        <span>Drag file from </span>
                                                                                                                        <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                        class='text-link' 
                                                                                                                                        urlqueryparam-view='resource-search'
                                                                                                                                        urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/3d_model'
                                                                                                                                        urlqueryparam-custom-label='Search 3D model'>
                                                                                                                                        3D model Library
                                                                                                                        </semantic-link>
                                                                                                                    
                                                                                                                        <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                                    urlqueryparam-view='resource-search' 
                                                                                                                                                    urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/3d_model'
                                                                                                                                                    urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                                    urlqueryparam-custom-label='Search 3D model'
                                                                                                                                                    >
                                                                                                                            <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding:0 8px 0 5px;' title='Open 3D model Library in new draggable tab'></rs-icon>
                                                                                                                        </semantic-link-container>
                                                                                                                        <span>or </span><span class='text-link'>click to upload</span>
                                                                                                                    </div>
                                                                                                                </div>"
                                                                                    nested-form-template='{{{{raw}}}}{{> forms:3dModel nested=true editable=true mode="new"}}{{{{/raw}}}}'
                                                                                                                >
                                                </semantic-form-drag-and-drop-input>
                                            </div>
                                        </div>
                                    </bs-tab-pane>
        
                                    <bs-tab-pane event-key="listView">
                                        <div class="tab-pane-content">
                                            <semantic-form-autocomplete-input   for='entity_3d_model' 
                                                                                label="3D model"
                                                                                render-header="false"
                                                                                placeholder="Select file" 
                                                                                nested-form-templates='[ 
                                                                                    {
                                                                                        "label": "3D model",
                                                                                        "nestedForm": "{{{{raw}}}}
                                                                                                        {{> \"http://www.researchspace.org/resource/system/forms/3dModel\" nested=true editable=true mode=\"new\"}}
                                                                                                    {{{{/raw}}}}"
                                                                                    }
                                                                                ]'> 
                                            </semantic-form-autocomplete-input>
                                        </div>
                                    </bs-tab-pane>
                                </bs-tab-content>
                            </div>
                        </bs-tab-container>
                    </bs-tab-pane>

                    [[#if signature]]
                        <bs-tab-pane event-key="{{viewId}}-resourceForm-signature" class="form-tabs-subtabs-content">
                            <bs-tab-container id="{{viewId}}-form-signature-tabs" default-active-key="thumbnailView" class="form-assetView-tabs">
                                <div>
                                    <div class="form-tabs-subtabs-content--title">
                                        <h4>Signature</h4>
                                        <div style="display: flex;align-items: center;gap: 20px;">
                                            {{#if node}}
                                                <semantic-query  query='SELECT ?signature WHERE {
                                                                            <{{node}}> crm:P14i_performed ?creation .
                                                                            ?creation crm:P94_has_created ?signature .
                                                                            ?signature a crm:E26_Physical_Feature .
                                                                        
                                                                            ?signature crm:P65_shows_visual_item ?mark .
                                                                            ?mark a crm:E37_Mark .
                                                                            ?mark crm:P2_has_type <http://www.researchspace.org/resource/vocab/mark_type/signature> .
                                                                            
                                                                            ?signature crm:P138i_has_representation ?signatureImage .
                                                                            ?signatureImage a ?type .
                                                                            FILTER(?type in (rs:EX_Digital_Image, rs:EX_Digital_Image_Region))
                                                                            ?signatureImage crm:P138_represents ?signature . 
                                                                        }'

                                                                template='{{> signatureImage}}'>

                                                    <template id='signatureImage'>
                                                        <div class="form-tabs-subtabs-content--title-actions">
                                                            <mp-overlay-dialog  id="[[urlParam 'viewid' escape=false]]-resource-signaturePreview-dialog"  
                                                                                type="modal" 
                                                                                class="modal-xlSize preview_modal"
                                                                                title="Image preview">
                                                                <mp-overlay-dialog-trigger>
                                                                    <button class="btn btn-icon" title="Image preview">
                                                                        <rs-icon icon-type="rounded" icon-name="fullscreen" symbol="true"></rs-icon>
                                                                    </button>
                                                                </mp-overlay-dialog-trigger>

                                                                <mp-overlay-dialog-content>
                                                                    <inline-template template-iri='[[resolvePrefix "rsp:ResourceImagesPreview"]]' 
                                                                                    options='{  "resource": "{{bindings.0.signature.value}}"
                                                                                                }' >
                                                                    </inline-template> 
                                                                </mp-overlay-dialog-content>
                                                            </mp-overlay-dialog>
                                                        

                                                            <mp-event-trigger id='{{viewId}}-image-annotation-add-frame-trigger' 
                                                                            type='Dashboard.AddFrame' 
                                                                            data='{"resourceIri": "{{node}}", 
                                                                                    "viewId": "image-annotation",
                                                                                    "frameId": "{{viewId}}"}' 
                                                                            targets='["thinking-frames"]'>
                                                            <button class="btn btn-icon" title="Image view / annotations">
                                                                <rs-icon icon-type="rounded" icon-name="photo_size_select_large" symbol="true"></rs-icon>
                                                            </button>
                                                        </mp-event-trigger>
                                                        </div>
                                                    </template>
                                                </semantic-query>
                                            {{/if}}
                                        
                                            <bs-nav class="icon-tabs">
                                                <bs-nav-item event-key="thumbnailView" title="thumbnail view">
                                                    <rs-icon icon-type="sharp" icon-name="view_module"></rs-icon>
                                                </bs-nav-item>
                                                <bs-nav-item event-key="listView" title="list view">
                                                    <rs-icon icon-type="sharp" icon-name="view_list"></rs-icon>
                                                </bs-nav-item>
                                            </bs-nav>
                                        </div>
                                    </div>
                                    <bs-tab-content>
                                        <bs-tab-pane event-key="thumbnailView">
                                            <div class="tab-pane-content">
                                                <div class="dragAndDrop-input-container">
                                                    <semantic-form-drag-and-drop-input  for='person_signature' 
                                                                                        label="Signature" 
                                                                                        render-header=false
                                                                                        placeholder-item-template="<div class='placeholder-item'>
                                                                                                                        <rs-icon icon-type='rounded' icon-name='upload' class='upload_icon' symbol='true'></rs-icon>
                                                                                                                        <div>
                                                                                                                            <div style='margin-bottom:3px;'>Drag image from </div>
                                                                                                                            <div style='margin-bottom:7px;'>
                                                                                                                                <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                                class='text-link' 
                                                                                                                                                urlqueryparam-view='resource-search'
                                                                                                                                                urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image'
                                                                                                                                                urlqueryparam-custom-label='Search Image'>
                                                                                                                                                Image Library
                                                                                                                                </semantic-link>
                                                                                                                            
                                                                                                                                <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                                            urlqueryparam-view='resource-search' 
                                                                                                                                                            urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image'
                                                                                                                                                            urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                                            urlqueryparam-custom-label='Search Image'
                                                                                                                                                            >
                                                                                                                                    <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding-left: 5px;' title='Open Image Library in new draggable tab'></rs-icon>
                                                                                                                                </semantic-link-container>
                                                                                                                        
                                                                                                                                <span style='padding:0 3px;'> or </span>
                                                                                                                        
                                                                                                                                <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                                class='text-link' 
                                                                                                                                                urlqueryparam-view='resource-search'
                                                                                                                                                urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                                                                                                                                urlqueryparam-custom-label='Search image annotation'>
                                                                                                                                    Image Annotation Library
                                                                                                                                </semantic-link>
                                                                                                                            
                                                                                                                                <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                                            urlqueryparam-view='resource-search' 
                                                                                                                                                            urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                                                                                                                                            urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                                            urlqueryparam-custom-label='Search image annotation'
                                                                                                                                                            >
                                                                                                                                    <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding-left: 5px;' title='Open Image Annotation Library in new draggable tab'></rs-icon>
                                                                                                                                </semantic-link-container>
                                                                                                                            </div>
                                                                                                                            <span>or </span><span class='text-link'>click to upload</span>
                                                                                                                        </div>
                                                                                                                    </div>"
                                                                                        nested-form-template='{{{{raw}}}}{{> forms:Image nested=true editable=true mode="new"}}{{{{/raw}}}}'>
                                                    </semantic-form-drag-and-drop-input>
                                                </div>
                                            </div>
                                        </bs-tab-pane>
            
                                        <bs-tab-pane event-key="listView">
                                            <div class="tab-pane-content">
                                        
                                                <semantic-form-autocomplete-input   for='person_signature' 
                                                                                    label="Signature"
                                                                                    render-header=false
                                                                                    placeholder="Select image" 
                                                                                    nested-form-templates='[ 
                                                                                        {
                                                                                            "label": "Image",
                                                                                            "nestedForm": "{{{{raw}}}}{{> \"http://www.researchspace.org/resource/system/forms/Image\" nested=true editable=true mode=\"new\" }}{{{{/raw}}}}"
                                                                                        }
                                                                                    
                                                                                    ]'> 
                                                </semantic-form-autocomplete-input>
                                            </div>
                                        </bs-tab-pane>
                                    </bs-tab-content>
                                    
                                </div>
                            </bs-tab-container>
                        </bs-tab-pane>
                    [[/if]]

                    <bs-tab-pane event-key="{{viewId}}-resourceForm-videos" class="form-tabs-subtabs-content">
                        <bs-tab-container id="{{viewId}}-form-video-tabs" default-active-key="thumbnailView" class="form-assetView-tabs">
                            <div>
                                <div class="form-tabs-subtabs-content--title">
                                    <h4>Videos</h4>
                                    <div style="display: flex;align-items: center;gap: 20px;">
                                        {{#if node}}
                                            <semantic-if    query='ASK { <{{node}}> crm:P129i_is_subject_of ?video . 
                                                                        ?video a frbroo:F26_Recording .
                                                                        ?video crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/recording_video> .
                                                                        ?video crm:P1_is_identified_by ?appellation .
                                                                        ?appellation a crm:E41_Appellation .
                                                                        ?appellation crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/primary_appellation> . 
                                                                        ?appellation crm:P190_has_symbolic_content ?label .
                                                                    }'
                                                            then='{{> then}}'>

                                                <template id='then'>
                                                    <div class="form-tabs-subtabs-content--title-actions">
                                                        <mp-overlay-dialog  id="[[urlParam 'viewid' escape=false]]-resource-videoPreview-dialog"  
                                                                            type="modal" 
                                                                            class="modal-xlSize preview_modal"
                                                                            title="Video preview">
                                                            <mp-overlay-dialog-trigger>
                                                                <button class="btn btn-icon" title="Video preview">
                                                                    <rs-icon icon-type="rounded" icon-name="fullscreen" symbol="true"></rs-icon>
                                                                </button>
                                                            </mp-overlay-dialog-trigger>

                                                            <mp-overlay-dialog-content>
                                                                <inline-template template-iri='[[resolvePrefix "rsp:ResourceVideosPreview"]]' 
                                                                                options='{ "resource": "{{node}}"
                                                                                        }' >
                                                                </inline-template> 
                                                            </mp-overlay-dialog-content>
                                                        </mp-overlay-dialog>
                                                    </div>
                                                </template>
                                            </semantic-if>
                                        {{/if}}
                                
                                        <bs-nav class="icon-tabs">
                                            <bs-nav-item event-key="thumbnailView" title="thumbnail view">
                                                <rs-icon icon-type="sharp" icon-name="view_module"></rs-icon>
                                            </bs-nav-item>
                                            <bs-nav-item event-key="listView" title="list view">
                                                <rs-icon icon-type="sharp" icon-name="view_list"></rs-icon>
                                            </bs-nav-item>
                                        </bs-nav>
                                    </div>
                                </div>
                    
                                <bs-tab-content>
                                    <bs-tab-pane event-key="thumbnailView">
                                        <div class="tab-pane-content">
                                            <div class="dragAndDrop-input-container">
                                                <semantic-form-drag-and-drop-input  for='entity_video' 
                                                                                    label="Videos" 
                                                                                    render-header=false
                                                                                    placeholder-item-template="<div class='placeholder-item'>
                                                                                                                    <rs-icon icon-type='rounded' icon-name='upload' class='upload_icon' symbol='true'></rs-icon>
                                                                                                                    <div>
                                                                                                                        <span>Drag video from </span>
                                                                                                                        <semantic-link  iri='http://www.researchspace.org/resource/ThinkingFrames' 
                                                                                                                                        class='text-link' 
                                                                                                                                        urlqueryparam-view='resource-search'
                                                                                                                                        urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Video'
                                                                                                                                        urlqueryparam-custom-label='Search Video'>
                                                                                                                                        Video Library
                                                                                                                        </semantic-link>
                                                                                                                    
                                                                                                                        <semantic-link-container    uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                                                                                                                    urlqueryparam-view='resource-search' 
                                                                                                                                                    urlqueryparam-iri='http://www.researchspace.org/resource/system/resource_configurations_container/data/Video'
                                                                                                                                                    urlqueryparam-open-as-drag-and-drop='true'
                                                                                                                                                    urlqueryparam-custom-label='Search Video'
                                                                                                                                                >
                                                                                                                            <rs-icon icon-type='rounded' icon-name='tab_move' symbol='true' style='padding:0 8px 0 5px;' title='Open Video Library in new draggable tab'></rs-icon>
                                                                                                                        </semantic-link-container>
                                                                                                                        <span>or </span><span class='text-link'>click to upload</span>
                                                                                                                    </div>
                                                                                                                </div>"
                                                                                    nested-form-template='{{{{raw}}}}{{> forms:Video nested=true editable=true mode="new"}}{{{{/raw}}}}'
                                                                                                                >
                                                </semantic-form-drag-and-drop-input>
                                            </div>
                                        </div>
                                    </bs-tab-pane>
        
                                    <bs-tab-pane event-key="listView">
                                        <div class="tab-pane-content">
                                            <semantic-form-autocomplete-input   for='entity_video' 
                                                                                label="Videos"
                                                                                render-header="false"
                                                                                placeholder="Select video" 
                                                                                nested-form-templates='[ 
                                                                                    {
                                                                                        "label": "Video",
                                                                                        "nestedForm": "{{{{raw}}}}
                                                                                                        {{> \"http://www.researchspace.org/resource/system/forms/Video\" nested=true editable=true mode=\"new\"}}
                                                                                                    {{{{/raw}}}}"
                                                                                    }
                                                                                ]'> 
                                            </semantic-form-autocomplete-input>
                                        </div>
                                    </bs-tab-pane>
                                </bs-tab-content>
                            </div>
                        </bs-tab-container>
                    </bs-tab-pane>

                    <bs-tab-pane event-key="{{viewId}}-resourceForm-representations" class="form-tabs-subtabs-content">
                        <bs-tab-container id="{{viewId}}-form-representations-tabs" default-active-key="listView" class="form-assetView-tabs">
                            <div>
                                <div class="form-tabs-subtabs-content--title">
                                    <h4>Visual representations</h4>
                                    <div>
                                        <bs-nav class="icon-tabs">
                                            <bs-nav-item event-key="thumbnailView" title="thumbnail view">
                                                <rs-icon icon-type="sharp" icon-name="view_module"></rs-icon>
                                            </bs-nav-item>
                                            <bs-nav-item event-key="listView" title="list view">
                                                <rs-icon icon-type="sharp" icon-name="view_list"></rs-icon>
                                            </bs-nav-item>
                                        </bs-nav>
                                    </div>
                                </div>
                    
                                <bs-tab-content>
                                    <bs-tab-pane event-key="thumbnailView">
                                        <div class="tab-pane-content">
                                            <div class="dragAndDrop-input-container">
                                                <semantic-form-drag-and-drop-input  for='entity_has_representation' 
                                                                                    label="Visual representations" 
                                                                                    render-header=false 
                                                                                    readonly='true'
                                                                                    placeholder-item-template="<div class='placeholder-item'>
                                                                                                                    <div>View visual representation</div>
                                                                                                                </div>"
                                                                                                                >
                                                </semantic-form-drag-and-drop-input>
                                            </div>
                                        </div>
                                    </bs-tab-pane>
        
                                    <bs-tab-pane event-key="listView">
                                        <div class="tab-pane-content">
                                            <div class="inline-composite-container">
                                                <semantic-form-composite-input  for="entity_represents_range" 
                                                                                label="Has visual representation"
                                                                                render-header="false"
                                                                                new-subject-template="/PC138_represents/{{{{raw}}}}{{UUID}}{{{{/raw}}}}"
                                                                                fields='[[fieldDefinitions
                                                                                        classtype="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
                                                                                                    
                                                                                        represents_visualItem_domain="http://www.researchspace.org/pattern/system/represents/domain"
                                                                                        mode_of_representation="http://www.researchspace.org/pattern/system/represents/mode_of_representation"
                                                                                        ]]'>
                                    
                                                <semantic-form-hidden-input for="classtype" default-value='http://www.cidoc-crm.org/cidoc-crm/PC138_represents'> </semantic-form-hidden-input>
                                    
                                                <div class="form-inline-inputs">
                                                <div style="flex: 1;">
                                                    <semantic-form-autocomplete-input   for='represents_visualItem_domain' 
                                                                                        render-header="false"
                                                                                        placeholder="Select what visually represents the entity"
                                                                                        nested-form-templates='[[> Platform:NestedFormTemplates_visualItems]]'>
                                                    </semantic-form-autocomplete-input>
                                                </div>
                                                <div style="flex: 1;">
                                                    <semantic-form-tree-picker-input  for="mode_of_representation" 
                                                                                    render-header="false"
                                                                                    placeholder="Select mode of representation"
                                                                                    close-dropdown-on-selection='true'
                                                                                    tree-patterns='{"scheme": "<http://www.researchspace.org/resource/vocab/mode_of_representation>", 
                                                                                                    "schemePattern": "?item <http://www.cidoc-crm.org/cidoc-crm/P71i_is_listed_in> <http://www.researchspace.org/resource/vocab/mode_of_representation>",
                                                                                                    "relationPattern": "?item crm:P127_has_broader_term ?parent"}'
                                    
                                                                                    scheme-page-button-config='{"iri": "http://www.researchspace.org/resource/ThinkingFrames",
                                                                                                                "view": "authority-list",
                                                                                                                "scheme": "http://www.researchspace.org/resource/vocab/mode_of_representation",
                                                                                                                "tooltip": "Open list of mode of representations"
                                                                                                                }'
                                                                                    
                                                                                    nested-form-template='{{{{raw}}}}{{> forms:Type nested=true editable=true mode="new"
                                                                                                                            scheme="http://www.researchspace.org/resource/vocab/mode_of_representation"
                                                                                                                            entityType="mode of representation" }}{{{{/raw}}}}'
                                    
                                                                                    query-item-label='SELECT ?label WHERE {
                                                                                                        ?item skos:prefLabel ?label .
                                                                                                    }'>
                                                    </semantic-form-tree-picker-input>
                                                </div>
                                                </div>
                                                </semantic-form-composite-input>
                                            </div>
                                        </div>
                                    </bs-tab-pane>
                                </bs-tab-content>
                                
                            </div>
                        </bs-tab-container>

                    </bs-tab-pane>

                    <bs-tab-pane event-key="{{viewId}}-resourceForm-URLlink" class="form-tabs-subtabs-content">
                        <bs-tab-container id="{{viewId}}-form-URLlink-tabs" default-active-key="listView" class="form-assetView-tabs">
                            <div>
                                <div class="form-tabs-subtabs-content--title">
                                    <h4>Web URL link</h4>
                                    <div>
                                        <bs-nav class="icon-tabs">
                                            <bs-nav-item event-key="listView" title="list view">
                                                <rs-icon icon-type="sharp" icon-name="view_list"></rs-icon>
                                            </bs-nav-item>
                                            <bs-nav-item event-key="tableView" title="List of web URL links">
                                                <rs-icon icon-type="sharp" icon-name="link"></rs-icon>
                                            </bs-nav-item>
                                        </bs-nav>
                                    </div>
                                </div>
                    
                                <bs-tab-content>
                                    <bs-tab-pane event-key="listView">
                                        <div class="tab-pane-content">
                                            <semantic-form-text-input for='entity_web_URL' label="Web URL link" render-header="false" placeholder="Enter web URL link"></semantic-form-text-input>
                                        </div>
                                    </bs-tab-pane>
                                    <bs-tab-pane event-key="tableView">
                                        <div class="tab-pane-content">
                                            <semantic-table id='web-link-table'
                                                            class-name="table-no-header table-no-margin"
                                                            query='SELECT DISTINCT ?link WHERE {
                                                                        <{{node}}> crm:P129i_is_subject_of ?digital_object .
                                                                        ?digital_object crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/digital_object_type/web_link> .
                                                                        ?digital_object crm:P190_has_symbolic_content ?link .
                                                                    
                                                                        ?digital_object crmdig:L11i_was_output_of ?digital_object_embed .
                                                                        ?digital_object_embed crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/digital_object_embed> .
                                                                        
                                                                    } 
                                                                    ORDER BY ASC(STR(LCASE(?link)))'
                                                            number-of-displayed-rows=10
                                                            options='{"showTableHeading":false}'
                                                            no-result-template='{{> noResults}}'
                                                            column-configuration='[ {"variableName": "vocabularyLabel", "displayName": "Web URL link", "cellTemplate": "{{> link}}" }
                                                                                ]'>
                                                
                                                <template id="noResults">
                                                    <div></div>
                                                </template>

                                                <template id='link'>
                                                    <a href="{{link.value}}" target="_blank" class="text-link">{{link.value}}</a>
                                                </template>
                                            </semantic-table>
                                        </div>
                                    </bs-tab-pane>
                                </bs-tab-content>
                            </div>
                        </bs-tab-container>
                    </bs-tab-pane>

                </bs-tab-content>
            </div>
        </bs-tab-container>
    [[/if]]

</div>
