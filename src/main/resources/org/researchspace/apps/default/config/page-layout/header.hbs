<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="rs-header">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#rs-navbar"
        aria-expanded="false" aria-controls="rs-navbar" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
     <a class="rs-header-logo" href="/">
        <img src="/assets/images/logos/researchspace_symbol_white.svg">
      </a>
{{!--      <a href="/">
        <div class='rs-header-title'>
          ResearchSpace
        </div>
      </a> --}}
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="rs-navbar">

      <ul class="nav navbar-nav navbar-left">
        
        <mp-anonymous-hidden>
          <li>
            <bs-dropdown id="navbar-dropdown">
              <bs-dropdown-toggle>
                <div>Create</div>
              </bs-dropdown-toggle>
              <bs-dropdown-menu>
                <div class="dropdown-sectionTitle">
                  ResearchSpace tools
                </div>
                <div class="dropdown-grid-container">
                  <semantic-link-container uri="http://www.researchspace.org/resource/ThinkingFrames" 
                                            urlqueryparam-view='semantic-narrative'>
                    <bs-menu-item>
                      <div class="dropdown-item-iconContainer">
                        <rs-icon icon-type="round" icon-name="description" style="color: #ffb450;"></rs-icon>
                      </div>
                      <div>
                        <div class="dropdown-item-title">Semantic narrative</div>
                        <div class="dropdown-item-description">Compose and share your research through an evolving narrative.</div>
                      </div>
                    </bs-menu-item>
                  </semantic-link-container>

                  <semantic-link-container uri="http://www.researchspace.org/resource/ThinkingFrames" 
                                            urlqueryparam-view='knowledge-map'>
                    <bs-menu-item>
                      <div class="dropdown-item-iconContainer">
                        <rs-icon icon-type="round" icon-name="account_tree" style="color: #ff7f66;"></rs-icon>
                      </div>
                      <div>
                        <div class="dropdown-item-title">Knowledge Map</div>
                        <div class="dropdown-item-description">Express research thinking and processes as networks of relations.</div>
                      </div>
                    </bs-menu-item>
                  </semantic-link-container>

                  <semantic-link-container uri="http://www.researchspace.org/resource/ThinkingFrames" 
                                            urlqueryparam-view='vocabulary'>
                    <bs-menu-item>
                      <div class="dropdown-item-iconContainer">
                        <i class="iconmoon iconmoon-books" style="color: #10BC7A;"></i>
                      </div>
                      <div>
                        <div class="dropdown-item-title">Vocabulary/Authority document</div>
                        <div class="dropdown-item-description">Create, view and edit vocabulary / authority list of terms.</div>
                      </div>
                    </bs-menu-item>
                  </semantic-link-container>

             {{!--     <semantic-link-container uri="http://www.researchspace.org/resource/ThinkingFrames" 
                                            urlqueryparam-view='vocabulary'>
                    <bs-menu-item>
                      <div class="dropdown-item-iconContainer">
                        <rs-icon icon-type="round" icon-name="image" style="color: #55A6FF;"></rs-icon>
                      </div>
                      <div>
                        <div class="dropdown-item-title">Image view and annotation</div>
                        <div class="dropdown-item-description">View, compare and annotate high-resolution images.</div>
                      </div>
                    </bs-menu-item>
                  </semantic-link-container>   --}}

                </div>
              </bs-dropdown-menu>
            </bs-dropdown>
          </li>
        </mp-anonymous-hidden>

        <mp-anonymous-hidden>
          <li>
            <mp-event-proxy id='closeModal-onSelect-newResource-proxy'
                          on-event-source='openResourceForm-in-new-frame-trigger' 
                          on-event-type='Dashboard.AddFrame'
                          proxy-event-type='OverlayDialog.Close' 
                          proxy-targets='["newResource-form-dialog"]'
            ></mp-event-proxy>

            <mp-overlay-dialog title="New resource" type="lightbox" id="newResource-form-dialog">
              <mp-overlay-dialog-trigger>
                <button class="btn btn-default btn-textAndIcon" style="margin-left: 30px;">
                  <rs-icon icon-type="round" icon-name="add_box"></rs-icon>
                  <span>New resource</span>
                </button>
              </mp-overlay-dialog-trigger>
              <mp-overlay-dialog-content>
                <bs-tab-container id="new-resource-tab-container" default-active-key="all">
                  <bs-tabs mount-on-enter="true">

                    <bs-tab event-key="all" title="All resources">
                      <div class="resources-tab-container">
                        <semantic-table  id='newResource-tab-results'
                                        query='SELECT ?resourceConfig ?resourceName ?resourceOntologyClass ?resourceFormIRI ?resourceIcon WHERE {
                                                ?resourceConfig a Platform:resource_configuration . 
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_name> ?resourceName .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_ontology_class> ?resourceOntologyClass .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_form> ?resourceFormIRI .
                                              
                                                OPTIONAL {
                                                  ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_card_icon> ?resourceIcon .
                                                }
                                                FILTER(?resourceConfig != <http://www.researchspace.org/resource/system/resource_configurations_container/data/KP_category>)
                                                FILTER(?resourceConfig != <http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation>)
                                                FILTER(?resourceConfig != <http://www.researchspace.org/resource/system/resource_configurations_container/data/Knowledge_map>)
                                                FILTER(?resourceConfig != <http://www.researchspace.org/resource/system/resource_configurations_container/data/Semantic_narrative>)
                                                FILTER(?resourceConfig != <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set>)
                                                FILTER(?resourceConfig != <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set_item>)
                                                FILTER(?resourceConfig != <http://www.researchspace.org/resource/system/resource_configurations_container/data/User>)
                                              } ORDER BY ASC(?resourceName)'

                                        tuple-template='\{{> newResourceCard}}',
                                        options='{"showFilter":true, "filterPlaceholderText":"Filter results by ontological type", "resultsPerPage":100}'
                      >
                        <template id='newResourceCard'>
                          <mp-event-trigger id='openResourceForm-in-new-frame-trigger' 
                                            type='Dashboard.AddFrame'
                                            data='{"viewId":"resource-editor", 
                                                  "entityTypeConfig": "\{{resourceConfig.value}}", 
                                                  "editable": true,
                                                  "customLabel": "New \{{resourceName.value}}",
                                                  "mode":"new"}' 
                                            targets='["thinking-frames"]'>

                              <div class="new-resource-card">
                                \{{#if resourceIcon}}
                                  <rs-icon icon-type="rounded" icon-name="\{{resourceIcon.value}}" symbol=true></rs-icon>
                                \{{else}}
                                  <rs-icon icon-type="rounded" icon-name="bubble_chart" symbol=true></rs-icon>
                                \{{/if}}
                                <div class="color-secondary text-font-size__base">\{{resourceName.value}}</div>
                              </div>
                          </mp-event-trigger>
                        </template>
                        </semantic-table>
                      </div>
                    </bs-tab>

                    <bs-tab event-key="general" title="Generic">
                      <div class="resources-tab-container">
                        <semantic-table id='newResource-tab-results'
                                        query='SELECT ?resourceConfig ?resourceName ?resourceOntologyClass ?resourceFormIRI ?resourceIcon WHERE {
                                                ?resourceConfig a Platform:resource_configuration . 
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_name> ?resourceName .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_ontology_class> ?resourceOntologyClass .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_form> ?resourceFormIRI .
                                                
                                                OPTIONAL {
                                                  ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_card_icon> ?resourceIcon .
                                                }
                                              
                                                FILTER (?resourceConfig NOT IN (
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set_item>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Semantic_narrative>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Knowledge_map>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/KP_category>)
                                                )

                                                  FILTER (EXISTS {?resourceOntologyClass rdfs:subClassOf crm:E1_CRM_Entity} || (?resourceOntologyClass = crm:E1_CRM_Entity)) 

                                              } ORDER BY ASC(?resourceName)'
                                        tuple-template='\{{> newResourceCard}}',
                                        
                                        options='{"showFilter":true, "filterPlaceholderText":"Filter results by ontological type", "resultsPerPage":300}'
                      >
                        <template id='newResourceCard'>
                          <mp-event-trigger id='openResourceForm-in-new-frame-trigger' 
                                            type='Dashboard.AddFrame'
                                            data='{"viewId":"resource-editor", 
                                                  "entityTypeConfig": "\{{resourceConfig.value}}", 
                                                  "editable": true,
                                                  "customLabel": "New \{{resourceName.value}}",
                                                  "mode":"new"}' 
                                            targets='["thinking-frames"]'>

                              <div class="new-resource-card">
                                \{{#if resourceIcon}}
                                  <rs-icon icon-type="rounded" icon-name="\{{resourceIcon.value}}" symbol=true></rs-icon>
                                \{{else}}
                                  <rs-icon icon-type="rounded" icon-name="bubble_chart" symbol=true></rs-icon>
                                \{{/if}}
                                <div class="color-secondary text-font-size__base">\{{resourceName.value}}</div>
                              </div>
                          </mp-event-trigger>
                        </template>
                        </semantic-table>
                      </div>
                    </bs-tab>

                    <bs-tab event-key="thing" title="Things">
                      <div class="resources-tab-container">
                        <semantic-table  id='newResource-tab-results'
                                        query='SELECT ?resourceConfig ?resourceName ?resourceOntologyClass ?resourceFormIRI ?resourceIcon WHERE {
                                                ?resourceConfig a Platform:resource_configuration . 
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_name> ?resourceName .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_ontology_class> ?resourceOntologyClass .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_form> ?resourceFormIRI .
                                              
                                                OPTIONAL {
                                                  ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_card_icon> ?resourceIcon .
                                                }

                                                FILTER (?resourceConfig NOT IN (
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set_item>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Semantic_narrative>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Knowledge_map>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/KP_category>,

                                                  #removed person, because subClass of Biological object
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Person>)
                                                )

                                                FILTER EXISTS {?resourceOntologyClass rdfs:subClassOf* crm:E18_Physical_Thing} 

                                              } ORDER BY ASC(?resourceName)'

                                        tuple-template='\{{> newResourceCard}}',
                                        options='{"showFilter":true, "filterPlaceholderText":"Filter results by ontological type", "resultsPerPage":50}'
                      >
                        <template id='newResourceCard'>
                          <mp-event-trigger id='openResourceForm-in-new-frame-trigger' 
                                            type='Dashboard.AddFrame'
                                            data='{"viewId":"resource-editor", 
                                                  "entityTypeConfig": "\{{resourceConfig.value}}", 
                                                  "editable": true,
                                                  "customLabel": "New \{{resourceName.value}}",
                                                  "mode":"new"}' 
                                            targets='["thinking-frames"]'>

                              <div class="new-resource-card">
                                \{{#if resourceIcon}}
                                  <rs-icon icon-type="rounded" icon-name="\{{resourceIcon.value}}" symbol=true></rs-icon>
                                \{{else}}
                                  <rs-icon icon-type="rounded" icon-name="bubble_chart" symbol=true></rs-icon>
                                \{{/if}}
                                <div class="color-secondary text-font-size__base">\{{resourceName.value}}</div>
                              </div>
                          </mp-event-trigger>
                        </template>
                        </semantic-table>
                      </div>
                    </bs-tab>

                    <bs-tab event-key="actor" title="Actors">
                      <div class="resources-tab-container">
                        <semantic-table  id='newResource-tab-results'
                                        query='SELECT ?resourceConfig ?resourceName ?resourceOntologyClass ?resourceFormIRI ?resourceIcon WHERE {
                                                ?resourceConfig a Platform:resource_configuration . 
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_name> ?resourceName .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_ontology_class> ?resourceOntologyClass .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_form> ?resourceFormIRI .
                                              
                                                OPTIONAL {
                                                  ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_card_icon> ?resourceIcon .
                                                }
                                                FILTER (?resourceConfig NOT IN (
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set_item>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Semantic_narrative>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Knowledge_map>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/KP_category>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/User>)
                                                )

                                                FILTER EXISTS {?resourceOntologyClass rdfs:subClassOf* crm:E39_Actor} 

                                              } ORDER BY ASC(?resourceName)'

                                        tuple-template='\{{> newResourceCard}}',
                                        options='{"showFilter":true, "filterPlaceholderText":"Filter results by ontological type", "resultsPerPage":50}'
                      >
                        <template id='newResourceCard'>
                          <mp-event-trigger id='openResourceForm-in-new-frame-trigger' 
                                            type='Dashboard.AddFrame'
                                            data='{"viewId":"resource-editor", 
                                                  "entityTypeConfig": "\{{resourceConfig.value}}", 
                                                  "editable": true,
                                                  "customLabel": "New \{{resourceName.value}}",
                                                  "mode":"new"}' 
                                            targets='["thinking-frames"]'>

                              <div class="new-resource-card">
                                \{{#if resourceIcon}}
                                  <rs-icon icon-type="rounded" icon-name="\{{resourceIcon.value}}" symbol=true></rs-icon>
                                \{{else}}
                                  <rs-icon icon-type="rounded" icon-name="bubble_chart" symbol=true></rs-icon>
                                \{{/if}}
                                <div class="color-secondary text-font-size__base">\{{resourceName.value}}</div>
                              </div>
                          </mp-event-trigger>
                        </template>
                        </semantic-table>
                      </div>
                    </bs-tab>

                    <bs-tab event-key="event" title="Events">
                      <div class="resources-tab-container">
                        <semantic-table  id='newResource-tab-results'
                                        query='SELECT ?resourceConfig ?resourceName ?resourceOntologyClass ?resourceFormIRI ?resourceIcon WHERE {
                                                ?resourceConfig a Platform:resource_configuration . 
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_name> ?resourceName .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_ontology_class> ?resourceOntologyClass .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_form> ?resourceFormIRI .
                                              
                                                OPTIONAL {
                                                  ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_card_icon> ?resourceIcon .
                                                }
                                                FILTER (?resourceConfig NOT IN (
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set_item>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Semantic_narrative>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Knowledge_map>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/KP_category>)
                                                )

                                                FILTER EXISTS {?resourceOntologyClass rdfs:subClassOf* crm:E2_Temporal_Entity} 

                                              } ORDER BY ASC(?resourceName)'

                                        tuple-template='\{{> newResourceCard}}',
                                        options='{"showFilter":true, "filterPlaceholderText":"Filter results by ontological type", "resultsPerPage":50}'
                      >
                        <template id='newResourceCard'>
                          <mp-event-trigger id='openResourceForm-in-new-frame-trigger' 
                                            type='Dashboard.AddFrame'
                                            data='{"viewId":"resource-editor", 
                                                  "entityTypeConfig": "\{{resourceConfig.value}}", 
                                                  "editable": true,
                                                  "customLabel": "New \{{resourceName.value}}",
                                                  "mode":"new"}' 
                                            targets='["thinking-frames"]'>

                              <div class="new-resource-card">
                                \{{#if resourceIcon}}
                                  <rs-icon icon-type="rounded" icon-name="\{{resourceIcon.value}}" symbol=true></rs-icon>
                                \{{else}}
                                  <rs-icon icon-type="rounded" icon-name="bubble_chart" symbol=true></rs-icon>
                                \{{/if}}
                                <div class="color-secondary text-font-size__base">\{{resourceName.value}}</div>
                              </div>
                          </mp-event-trigger>
                        </template>
                        </semantic-table>
                      </div>
                    </bs-tab>

                    <bs-tab event-key="concepts" title="Conceptual objects">
                      <div class="resources-tab-container">
                        <semantic-table  id='newResource-tab-results'
                                        query='SELECT ?resourceConfig ?resourceName ?resourceOntologyClass ?resourceFormIRI ?resourceIcon WHERE {
                                                ?resourceConfig a Platform:resource_configuration . 
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_name> ?resourceName .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_ontology_class> ?resourceOntologyClass .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_form> ?resourceFormIRI .
                                              
                                                OPTIONAL {
                                                  ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_card_icon> ?resourceIcon .
                                                }

                                                FILTER (?resourceConfig NOT IN (
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set_item>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Set>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Semantic_narrative>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Knowledge_map>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/KP_category>,

                                                  #following resources are removed as listed in System resources or not for data entry,but only for resource edit
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Authority_document>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Document>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Image>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Audio>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Video>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/3d_model>,
                                                  <http://www.researchspace.org/resource/system/resource_configurations_container/data/Publication>)
                                                )

                                                FILTER EXISTS {?resourceOntologyClass rdfs:subClassOf* crm:E28_Conceptual_Object} 

                                              } ORDER BY ASC(?resourceName)'

                                        tuple-template='\{{> newResourceCard}}',
                                        options='{"showFilter":true, "filterPlaceholderText":"Filter results by ontological type", "resultsPerPage":50}'
                      >
                        <template id='newResourceCard'>
                          <mp-event-trigger id='openResourceForm-in-new-frame-trigger' 
                                            type='Dashboard.AddFrame'
                                            data='{"viewId":"resource-editor", 
                                                  "entityTypeConfig": "\{{resourceConfig.value}}", 
                                                  "editable": true,
                                                  "customLabel": "New \{{resourceName.value}}",
                                                  "mode":"new"}' 
                                            targets='["thinking-frames"]'>

                              <div class="new-resource-card">
                                \{{#if resourceIcon}}
                                  <rs-icon icon-type="rounded" icon-name="\{{resourceIcon.value}}" symbol=true></rs-icon>
                                \{{else}}
                                  <rs-icon icon-type="rounded" icon-name="bubble_chart" symbol=true></rs-icon>
                                \{{/if}}
                                <div class="color-secondary text-font-size__base">\{{resourceName.value}}</div>
                              </div>
                          </mp-event-trigger>
                        </template>
                        </semantic-table>
                      </div>
                    </bs-tab>

                    <bs-tab event-key="system" title="System resources">
                      <div class="resources-tab-container">
                        <semantic-table  id='newResource-tab-results'
                                        query='SELECT ?resourceConfig ?resourceName ?resourceFormIRI ?resourceIcon WHERE {
                                                VALUES (?resourceConfig) { 
                                                  (<http://www.researchspace.org/resource/system/resource_configurations_container/data/Authority_document>)
                                                  (<http://www.researchspace.org/resource/system/resource_configurations_container/data/Document>)
                                                  (<http://www.researchspace.org/resource/system/resource_configurations_container/data/Image>)
                                                  (<http://www.researchspace.org/resource/system/resource_configurations_container/data/Publication>)
                                                  (<http://www.researchspace.org/resource/system/resource_configurations_container/data/Audio>)
                                                  (<http://www.researchspace.org/resource/system/resource_configurations_container/data/Video>)
                                                  (<http://www.researchspace.org/resource/system/resource_configurations_container/data/3d_model>)
                                                }

                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_name> ?resourceName .
                                                ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_form> ?resourceFormIRI .
                                                OPTIONAL {
                                                  ?resourceConfig <http://www.researchspace.org/pattern/system/resource_configuration/resource_card_icon> ?resourceIcon .
                                                }
                                              } ORDER BY ASC(?resourceName)'

                                        tuple-template='\{{> newResourceCard}}',
                                        options='{"showFilter":true, "filterPlaceholderText":"Filter results by ontological type", "resultsPerPage":50}'
                      >
                        <template id='newResourceCard'>
                          <mp-event-trigger id='openResourceForm-in-new-frame-trigger' 
                                            type='Dashboard.AddFrame'
                                            data='{"viewId":"resource-editor", 
                                                  "entityTypeConfig": "\{{resourceConfig.value}}", 
                                                  "editable": true,
                                                  "customLabel": "New \{{resourceName.value}}",
                                                  "mode":"new"}' 
                                            targets='["thinking-frames"]'>

                              <div class="new-resource-card">
                                \{{#if resourceIcon}}
                                  <rs-icon icon-type="rounded" icon-name="\{{resourceIcon.value}}" symbol=true></rs-icon>
                                \{{else}}
                                  <rs-icon icon-type="rounded" icon-name="bubble_chart" symbol=true></rs-icon>
                                \{{/if}}
                                <div class="color-secondary text-font-size__base">\{{resourceName.value}}</div>
                              </div>
                          </mp-event-trigger>
                        </template>
                        </semantic-table>
                      </div>
                    </bs-tab>

                  </bs-tabs>
                </bs-tab-container>

              </mp-overlay-dialog-content>
            </mp-overlay-dialog>
          </li>
        </mp-anonymous-hidden>

        <mp-anonymous-hidden>
          <li>
            <mp-event-trigger id='openProjectForm-in-new-frame-trigger' 
                              type='Dashboard.AddFrame'
                              data='{"viewId":"resource-editor", 
                                    "entityTypeConfig": "http://www.researchspace.org/resource/system/resource_configurations_container/data/Project", 
                                    "editable": true,
                                    "customLabel": "New project",
                                    "mode":"new"}' 
                              targets='["thinking-frames"]'>

              <button class="btn btn-action btn-textAndIcon" >
                <rs-icon icon-type="round" icon-name="add_box"></rs-icon>
                <span>New Project</span>
              </button>
            </mp-event-trigger>
            
          </li>
        </mp-anonymous-hidden>

   {{!--      <bs-nav-dropdown id="test-dropdown" title="Testing">

            <semantic-link-container  uri="http://www.researchspace.org/resource/ThinkingFrames"
                                      urlqueryparam-view='resource-editor' 
                                      urlqueryparam-entity-type-config='http://www.researchspace.org/resource/system/resource_configurations_container/data/Knowledge_map'
                                      urlqueryparam-mode='new'>
              <bs-menu-item>knowledge map</bs-menu-item>
            </semantic-link-container>
          
            <semantic-link-container uri="http://www.researchspace.org/resource/ThinkingFrames"
                                      urlqueryparam-view='resource-editor' 
                                      urlqueryparam-entity-type-config='http://www.researchspace.org/resource/system/resource_configurations_container/data/Semantic_narrative'
                                      urlqueryparam-mode='new'>
              <bs-menu-item>semantic narrative</bs-menu-item>
            </semantic-link-container>
          
            <semantic-link-container uri="http://www.researchspace.org/resource/ThinkingFrames"
                                    urlqueryparam-view='resource-editor' 
                                    urlqueryparam-entity-type-config='http://www.researchspace.org/resource/system/resource_configurations_container/data/Image_annotation'
                                    urlqueryparam-mode='new'>
              <bs-menu-item>image annotation</bs-menu-item>
            </semantic-link-container>

            <semantic-link-container  uri="http://www.researchspace.org/resource/ThinkingFrames"
                                      urlqueryparam-view='resource-editor' 
                                      urlqueryparam-entity-type-config='http://www.researchspace.org/resource/system/resource_configurations_container/data/Set'
                                      urlqueryparam-mode='new'>
              <bs-menu-item>Set</bs-menu-item>
            </semantic-link-container>

            <semantic-link-container  uri="http://www.researchspace.org/resource/ThinkingFrames"
                                      urlqueryparam-view='resource-editor' 
                                      urlqueryparam-entity-type-config='http://www.researchspace.org/resource/system/resource_configurations_container/data/User'
                                      urlqueryparam-mode='new'>
              <bs-menu-item>User</bs-menu-item>
            </semantic-link-container>

        </bs-nav-dropdown> --}}

      </ul>

      <ul class="nav navbar-nav navbar-right">
        {{!-- Update profile-dropdown on resourceForm actions --}}
        <semantic-query query='SELECT ?systemUser WHERE {
                                BIND(IRI(REPLACE(STR(?__useruri__), "%40", "_")) as ?systemUser)
                              }'
                        template='\{{> template}}'>
            <template id='template'>
              <div>
                <mp-event-proxy id='update-profile-dropdown-on-resourceForm-actions2'
                                on-event-source='\{{bindings.0.systemUser.value}}-resource-form'
                                on-event-types='["Form.ResourceCreated", "Form.ResourceUpdated", "Form.ResourceRemoved"]'         
                                proxy-event-type='Component.TemplateUpdate' 
                                proxy-targets='["header-profile-dropdown"]'
                ></mp-event-proxy> 
              </div>
            </template>
        </semantic-query>

        <mp-user-language-switch></mp-user-language-switch>
        <li>
          <mp-anonymous-hidden alt='<li><a href="/login" title="login"></a></li>'>
            <mp-event-target-template-render id='header-profile-dropdown' template='\{{> template}}'>
              <template id='template'>
                <semantic-query query='SELECT DISTINCT ?systemUser ?systemUserName ?actorFullName ?mainImage ?mainImageClass ?group ?groupFullName { 
                                        BIND(IRI(REPLACE(STR(?__useruri__), "%40", "_")) as ?systemUser)
                                        BIND(REPLACE(REPLACE(STR(?__useruri__), STR(User:), ""), "%40", "@") as ?systemUserName)

                                        OPTIONAL {
                                          ?systemUser crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/user> .
                                          ?systemUser crm:P1_is_identified_by ?actorName .
                                          ?actorName a crm:E41_Appellation .
                                          ?actorName crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/primary_appellation> .
                                          ?actorName crm:P190_has_symbolic_content ?actorFullName .
                                        }

                                        OPTIONAL {
                                          ?systemUser rs:PX_has_main_representation ?mainImage .
                                          ?mainImage a ?mainImageClass .
                                          FILTER(?mainImageClass in (rs:EX_Digital_Image, rs:EX_Digital_Image_Region))
                                        }

                                        OPTIONAL {
                                          ?systemUser crm:P02i_is_range_of ?pc107 .
                                          ?pc107 rdf:type crm:PC107_has_current_or_former_member .
                                          ?pc107 crm:P01_has_domain ?group .
                                          ?group crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/user> .
                                          ?group a crm:E74_Group .
                                          ?group crm:P1_is_identified_by ?groupName .
                                          ?groupName a crm:E41_Appellation .
                                          ?groupName crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/primary_appellation> .
                                          ?groupName crm:P190_has_symbolic_content ?groupFullName .
                                        }
                                      }'
                              template='\{{> template}}'>

                <template id='template'>

                  <bs-dropdown id="navbar-dropdown" class="user-dropdown">
                    <bs-dropdown-toggle>
                      <div class="navDropdown-iconAndLabel"> 
                        \{{#if (eq bindings.0.mainImageClass.value "http://www.researchspace.org/ontology/EX_Digital_Image_Region")}}
                          <rs-iiif-image-thumbnail  height='25' width='25' style='width: 25px; height:25px; border-radius:1.5px; object-fit: cover; object-position: top;'
                                                    image-or-region='\{{bindings.0.mainImage.value}}'
                                                    image-id-pattern='OPTIONAL { ?imageIRI crmdig:L60i_is_documented_by/crmdig:L11_had_output/rs:PX_has_file_name ?carrierImageID. } BIND(COALESCE(?carrierImageID, ENCODE_FOR_URI(ENCODE_FOR_URI(REPLACE(STR(?imageIRI), "^.*/(.*)$", "$1")))) AS ?imageID) .'
			                                              iiif-server-url='/proxy/IIIF'>
                          </rs-iiif-image-thumbnail>
                        \{{else}}
                          <mp-resource-thumbnail iri='\{{bindings.0.systemUser.value}}' style="width: 25px; height:25px; border-radius:1.5px; object-fit: cover; object-position: top;">
                            <mp-resource-thumbnail-fallback>
                                <rs-icon icon-type="round" icon-name="account_box"></rs-icon>
                            </mp-resource-thumbnail-fallback>
                          </mp-resource-thumbnail>  
                        \{{/if}}
                        \{{#if bindings.0.actorFullName.value}}
                          <div>\{{bindings.0.actorFullName.value}}</div>
                        \{{else}}
                          <div>\{{bindings.0.systemUserName.value}}</div>
                        \{{/if}}
                      </div>
                    </bs-dropdown-toggle>
                    <bs-dropdown-menu>
                      \{{#if bindings.0.actorFullName.value}}
                        <semantic-link-container  uri="http://www.researchspace.org/resource/ThinkingFrames"
                                                  urlqueryparam-view='resource-editor' 
                                                  urlqueryparam-entity-type-config='http://www.researchspace.org/resource/system/resource_configurations_container/data/User'
                                                  urlqueryparam-resource-iri="\{{bindings.0.systemUser.value}}"
                                                  urlqueryparam-mode='edit'>
                          <bs-menu-item>
                            <rs-icon icon-type="round" icon-name="account_box" class="icon-left"></rs-icon>
                            <span>My profile</span> 
                          </bs-menu-item>
                        </semantic-link-container>
                      \{{else}}
                        <semantic-link-container uri='http://www.researchspace.org/resource/ThinkingFrames'
                                                urlqueryparam-view='resource-editor' 
                                                urlqueryparam-entity-type-config='http://www.researchspace.org/resource/system/resource_configurations_container/data/User'
                                                urlqueryparam-custom-label='New profile'
                                                urlqueryparam-mode='new'>
                          <bs-menu-item>
                            <rs-icon icon-type="round" icon-name="account_box" class="icon-left"></rs-icon>
                            <span>My profile (not registered user)</span>  
                          </bs-menu-item>
                        </semantic-link-container>
                      \{{/if}}
                      
                      \{{#if bindings.0.group.value}}
                        \{{#each bindings}}
                          <semantic-link-container  uri="http://www.researchspace.org/resource/ThinkingFrames"
                                                    urlqueryparam-view='resource-editor' 
                                                    urlqueryparam-entity-type-config='http://www.researchspace.org/resource/system/resource_configurations_container/data/User'
                                                    urlqueryparam-resource-iri="\{{group.value}}"
                                                    urlqueryparam-mode='edit'>
                            <bs-menu-item>
                              <rs-icon icon-type="round" icon-name="groups" class="icon-left"></rs-icon>
                              <span>My team - \{{groupFullName.value}}</span>
                            </bs-menu-item>
                          </semantic-link-container>
                        \{{/each}}
                      \{{/if}}

                      <bs-menu-item divider="true"></bs-menu-item>

                      <bs-menu-item href="/logout" title='logout'>
                        <rs-icon icon-type="round" icon-name="logout" class="icon-left"></rs-icon>
                        <span>Logout</span>
                      </bs-menu-item>
                    </bs-dropdown-menu>
                  </bs-dropdown>
                </template>
                </semantic-query>
              </template>
            </mp-event-target-template-render>
          </mp-anonymous-hidden>
        </li>

        <li>
        {{!--  <bs-dropdown id="navbar-dropdown" class="feedback-dropdown">
              <bs-dropdown-toggle class="btn btn-icon">
                <rs-icon icon-type="round" icon-name="forum"></rs-icon>
              </bs-dropdown-toggle>
              <bs-dropdown-menu>
                  <bs-menu-item>
                    <rs-icon icon-type="round" icon-name="add_box" class="icon-left"></rs-icon>
                    New feedback
                  </bs-menu-item>

                  <bs-menu-item>
                    <rs-icon icon-type="round" icon-name="feed" class="icon-left"></rs-icon>
                    All feedback
                  </bs-menu-item>
              </bs-dropdown-menu>
          </bs-dropdown> --}}
            <mp-overlay-dialog id="header-contact-modal" type="modal" bs-size="large" class="header-contact-modal">
              <mp-overlay-dialog-trigger>
                <button class="btn btn-icon">
                  <rs-icon icon-type="round" icon-name="forum"></rs-icon>
                </button>
              </mp-overlay-dialog-trigger>

              <mp-overlay-dialog-content>
                   <div class="contact-container">
                    <div class="contact-motif"></div>
                    <div class="contact-header">
                      <div class="title">Contact & Support</div>
                      <div class="contact-icons-container">
                          <a href="https://www.researchspace.org/" title="Researchspace website" target="_blank">
                            <i class="rs-icon rs-icon-researchspace"></i>
                          </a>
                          <a href="mailto:info@kartography.org" title="mailto:info@kartography.org" target="_blank">
                            <i class="rs-icon rs-icon-mail_send"></i>
                          </a>
                          <a href="https://www.youtube.com/channel/UCtUOzTB2vBG9ZimeDVrlULQ/featured" title="Youtube researchspace" target="_blank">
                            <i class="rs-icon rs-icon-youtube"></i>
                          </a>
                          <a href="https://x.com/researchspace" title="X researchspace" target="_blank">
                            <img src="/assets/images/logos/x-social-media-logo.svg">
                          </a>

                          <a href="https://github.com/researchspace/researchspace" title="Github researchspace" target="_blank">
                            <i class="fa fa-github-square"></i>
                          </a>
                      </div>
                    </div>

                    <div class="contact-content">
                      <div>This version of ResearchSpace is released and supported by <a href="https://kartography.org/" title="Kartography" target="_blank" class="text-link-action">Kartography CIC</a>.</div>
                      <div style="padding: 10px 0 10px 0;">Kartography offers:</div>
                      <div class="contact-card-container">
                        <div class="contact-card"> 
                          <rs-icon icon-type="rounded" icon-name="school" symbol="true"></rs-icon>
                          <div>
                            <div class="card-title">Training</div>
                            <div class="card-content">Workshops and personalised training sessions on how to use ResearchSpace are organised periodically by Kartography or available on request.</div>
                          </div>
                        </div>
                        <div class="contact-card"> 
                          <rs-icon icon-type="rounded" icon-name="live_help" symbol="true"></rs-icon>
                          <div>
                            <div class="card-title">Technical support</div>
                            <div class="card-content">description</div>
                          </div>
                        </div>
                        <div class="contact-card"> 
                          <rs-icon icon-type="rounded" icon-name="display_settings" symbol="true"></rs-icon>
                          <div>
                            <div class="card-title">Customisations of ResearchSpace</div>
                            <div class="card-content">Domain focus customisation of ResearchSpace functionalities can be develop to support your project or your institution.</div>
                          </div>
                        </div>
                        <div class="contact-card"> 
                          <rs-icon icon-type="rounded" icon-name="linked_services" symbol="true"></rs-icon>
                          <div>
                            <div class="card-title">Knowledge representation through semantic data</div>
                            <div class="card-content">Expertise on CIDOC CRM data modelling</div>
                          </div>
                        </div>
                        <div class="contact-card"> 
                          <rs-icon icon-type="rounded" icon-name="biotech" symbol="true"></rs-icon>
                          <div>
                            <div class="card-title">Consultancy on digital research metodology</div>
                            <div class="card-content">Semantic Web Application Design/User oriented software design and development</div>
                          </div>
                        </div>
                        <div class="contact-card"> 
                          <rs-icon icon-type="rounded" icon-name="data_exploration" symbol="true"></rs-icon>
                          <div>
                            <div class="card-title">Focused expertise on data diversity and contextualisation</div>
                            <div class="card-content">description</div>
                          </div>
                        </div>

                      </div>
                      <div class="contact-content-buttons">
                        <mp-event-trigger id='header-close-header-contact-modal' 
                                          type='OverlayDialog.Close' 
                                          targets='["header-contact-modal"]'>
                          <button class="btn btn-default">Close</button>
                        </mp-event-trigger>
                      </div>
                    </div>
                  </div>

                

                
                
              </mp-overlay-dialog-content>
          </mp-overlay-dialog>
          
        </li>

        <li>
          <button class="btn btn-icon">
            <a href="https://documentation.researchspace.org/resource/rsp:Start" title="Help center" target="_blank">
              <rs-icon icon-type="round" icon-name="help_center"></rs-icon>
            </a>
          </button>
        </li>

        <mp-anonymous-hidden>
          <li>
            <button class="btn btn-icon">
              <semantic-link iri="http://www.researchspace.org/resource/admin" title="System Settings" target="_blank">
                <rs-icon icon-type="round" icon-name="settings"></rs-icon>
              </semantic-link>
            </button>
          </li>
        </mp-anonymous-hidden>

      </ul>
    </div>
  </div>
</nav>


